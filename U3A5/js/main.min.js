var U3A5,__bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};U3A5=function(a){function b(){this.finish=__bind(this.finish,this),this.storyTale=__bind(this.storyTale,this),this.nextEvaluation=__bind(this.nextEvaluation,this),this.finishEvaluation=__bind(this.finishEvaluation,this),this.evaluateAnswer=__bind(this.evaluateAnswer,this),this.initEvaluation=__bind(this.initEvaluation,this);var a,c;a=[{id:"head",src:"pleca1.png"},{id:"c1",src:"circle1.png"},{id:"c2",src:"circle2.png"},{id:"repeatbtn",src:"repeat-btn.png"},{id:"playagain",src:"play_again.png"},{id:"startgame",src:"start_game.png"},{id:"title1",src:"title1.png"},{id:"1",src:"1.png"},{id:"2",src:"2.png"},{id:"3",src:"3.png"},{id:"4",src:"4.png"},{id:"5",src:"5.png"},{id:"6",src:"6.png"},{id:"7",src:"7.png"},{id:"8",src:"8.png"},{id:"1b",src:"1b.png"},{id:"2b",src:"2b.png"},{id:"3b",src:"3b.png"},{id:"4b",src:"4b.png"},{id:"5b",src:"5b.png"},{id:"6b",src:"6b.png"},{id:"7b",src:"7b.png"},{id:"8b",src:"8b.png"},{id:"1p1",src:"1p1.png"},{id:"1p2",src:"1p2.png"},{id:"4p1",src:"4p1.png"},{id:"4p2",src:"4p2.png"},{id:"5p1",src:"5p1.png"},{id:"5p2",src:"5p2.png"},{id:"6p1",src:"6p1.png"},{id:"6p2",src:"6p2.png"},{id:"btn",src:"btn.png"}],c=[{src:"sounds/good.mp3",id:"good"},{src:"sounds/wrong.mp3",id:"wrong"},{src:"sounds/TU2_U3_A5_instructions.mp3",id:"instructions"},{src:"sounds/TU2_U3_A5_scene1.mp3",id:"scene1"},{src:"sounds/TU2_U3_A5_scene2.mp3",id:"scene2"}],this.game=[{texts:[{idx:3,t:"flashlight"},{idx:4,t:"presents",p:"p1"},{idx:1,t:"candles",p:"p1"},{idx:2,t:"cake"},{idx:1,t:"kitchen",p:"p2"},{idx:4,t:"soccer ball",p:"p2"}],positions:[{x:224,y:332},{x:668,y:306},{x:216,y:768},{x:650,y:758}]},{texts:[{idx:8,t:"father"},{idx:5,t:"quiet",p:"p2"},{idx:5,t:"eyes",p:"p1"},{idx:7,t:"door"},{idx:6,t:"storm",p:"p1"},{idx:6,t:"grandpa",p:"p2"}],positions:[{x:206,y:340},{x:652,y:306},{x:200,y:756},{x:636,y:742}]}],this.answers=[],b.__super__.constructor.call(this,null,a,c)}return __extends(b,a),b.prototype.setStage=function(){var a,c;return b.__super__.setStage.apply(this,arguments),this.insertBitmap("header","head",stageSize.w/2,0,"tc"),this.insertInstructions("instructions",["Read and drag the words to complete the story."],80,200),c=this.createBitmap("title","title1",700,230,"tc"),c.scaleX=c.scaleY=.8,this.addToMain(c),a=new Button("btnnext",this.preload.getResult("btn"),0,1220,1040),this.addToMain(a),this.library.btnnext.visible=!1,this.addToMain(new Score("score",this.preload.getResult("c1"),this.preload.getResult("c2"),40,1e3,12,0)),this.intento=0,this.setCuento(1).introEvaluation()},b.prototype.setCuento=function(a){var b,c,d,e,f,g,h,i,j,k;for(b=new createjs.Container,b.name="cuento",this.scene=a,c=h=1,j=this.game[a-1].positions.length;j>=h;c=h+=1)1===a&&(1===c||4===c?(f=this.createSprite("sc"+c,[""+(4*(a-1)+c),""+(4*(a-1)+c)+"p1",""+(4*(a-1)+c)+"p2",""+(4*(a-1)+c)+"b"],null,0,0),f.mouseEnabled=!1,d=new createjs.Shape,d.graphics.beginFill("rgba(255,255,255,0.1)").drawRect(0,0,f.getBounds().width,f.getBounds().height),e=new createjs.Container,e.set({name:"sc"+c,index:4*(a-1)+c,x:this.game[a-1].positions[c-1].x,y:this.game[a-1].positions[c-1].y,sprite:f,shape:d}),e.addChild(f,d)):(f=this.createSprite("sc"+c,[""+(4*(a-1)+c),""+(4*(a-1)+c)+"b"],null,0,0),f.mouseEnabled=!1,d=new createjs.Shape,d.graphics.beginFill("rgba(255,255,255,0.1)").drawRect(0,0,f.getBounds().width,f.getBounds().height),e=new createjs.Container,e.set({name:"sc"+c,index:4*(a-1)+c,x:this.game[a-1].positions[c-1].x,y:this.game[a-1].positions[c-1].y,sprite:f,shape:d}),e.addChild(f,d))),2===a&&(1===c||2===c?(f=this.createSprite("sc"+c,[""+(4*(a-1)+c),""+(4*(a-1)+c)+"p1",""+(4*(a-1)+c)+"p2",""+(4*(a-1)+c)+"b"],null,0,0),f.mouseEnabled=!1,d=new createjs.Shape,d.graphics.beginFill("rgba(255,255,255,0.1)").drawRect(0,0,f.getBounds().width,f.getBounds().height),e=new createjs.Container,e.set({name:"sc"+c,index:4*(a-1)+c,x:this.game[a-1].positions[c-1].x,y:this.game[a-1].positions[c-1].y,sprite:f,shape:d}),e.addChild(f,d)):(f=this.createSprite("sc"+c,[""+(4*(a-1)+c),""+(4*(a-1)+c)+"b"],null,0,0),f.mouseEnabled=!1,d=new createjs.Shape,d.graphics.beginFill("rgba(255,255,255,0.1)").drawRect(0,0,f.getBounds().width,f.getBounds().height),e=new createjs.Container,e.set({name:"sc"+c,index:4*(a-1)+c,x:this.game[a-1].positions[c-1].x,y:this.game[a-1].positions[c-1].y,sprite:f,shape:d}),e.addChild(f,d))),e.scaleX=e.scaleY=1.1,b.addChild(e),this.addToLibrary(e);for(c=i=1,k=this.game[a-1].texts.length;k>=i;c=i+=1)g=new DraggableText("t"+c,this.game[a-1].texts[c-1].t,this.game[a-1].texts[c-1].idx,1400,120*c+320),g.text.lineHeight=40,g.text.lineWidth=400,g.text.textAlign="center",g.setHitArea(),this.game[a-1].texts[c-1].p&&(g.p=this.game[a-1].texts[c-1].p),this.addToLibrary(g),b.addChild(g);return this.addToMain(b),this},b.prototype.setCuentoFinal=function(a){var b,c,d,e,f,g;for(b=new createjs.Container,b.name="cuento",this.scene=a,e=this.game[a-1],c=f=1,g=e.positions.length;g>=f;c=f+=1)d=this.createBitmap(""+(4*(a-1)+c)+"b",""+(4*(a-1)+c)+"b",e.positions[c-1].x,e.positions[c-1].y),d.scaleX=d.scaleY=1.1,b.addChild(d),this.addToLibrary(d);return this.addToMain(b)},b.prototype.introEvaluation=function(){var a,c,d;for(b.__super__.introEvaluation.apply(this,arguments),a=c=1,d=this.game[this.scene-1].texts.length;d>=c;a=c+=1)this.observer.subscribe("init_evaluation",this.library["t"+a].onInitEvaluation);return TweenLite.from(this.library.header,1,{y:-this.library.header.height}),TweenLite.from(this.library.instructions,1,{alpha:0,x:0,delay:1}),TweenLite.from(this.library.title,1,{alpha:0,y:this.library.title.y+40,delay:2}),TweenLite.from(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+40,delay:3,onComplete:this.playInstructions,onCompleteParams:[this]})},b.prototype.initEvaluation=function(){var a,c,d,e;for(b.__super__.initEvaluation.apply(this,arguments),e=[],a=c=1,d=this.game[this.scene-1].texts.length;d>=c;a=c+=1)e.push(this.library["t"+a].addEventListener("click",this.evaluateAnswer));return e},b.prototype.evaluateAnswer=function(a){var b,c,d,e,f,g,h;for(this.answer=a.currentTarget,b=!1,h=[],c=e=1,f=this.game[this.scene-1].positions.length;f>=e;c=e+=1)d=this.library["sc"+c].shape.globalToLocal(this.stage.mouseX,this.stage.mouseY),this.library["sc"+c].shape.hitTest(d.x,d.y)?this.answer.index===this.library["sc"+c].index?(this.library["sc"+c].sprite.gotoAndStop(this.answer.p?1===(g=this.library["sc"+c].sprite.currentFrame)||2===g?3:"p1"===this.answer.p?1:2:1),0===this.intento&&this.library.score.plusOne(),this.intento=0,this.answer.visible=!1,createjs.Sound.stop(),createjs.Sound.play("good"),h.push(this.finishEvaluation())):(this.warning(),this.intento=1,h.push(this.answer.returnToPlace())):h.push(this.answer.returnToPlace());return h},b.prototype.finishEvaluation=function(){var a,b,c;for(a=b=1,c=this.game[this.scene-1].positions.length;c>=b;a=b+=1)if(this.library["sc"+a].sprite.currentFrame!==this.library["sc"+a].sprite.spriteSheet._frames.length-1)return;return this.scene<2?(this.library.btnnext.visible=!0,this.library.btnnext.alpha=1,this.library.btnnext.y=1040,TweenLite.from(this.library.btnnext,1,{alpha:0,y:this.library.btnnext.y+20}),this.library.btnnext.addEventListener("click",this.nextEvaluation)):this.nextEvaluation()},b.prototype.nextEvaluation=function(){var a,b,c,d;if(this.index++,this.index<this.game.length){for(TweenLite.to(this.library.btnnext,1,{alpha:0,y:this.library.btnnext.y+20}),TweenLite.to(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+20}),this.setCuento(this.index+1),TweenLite.from(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+20}),d=[],a=b=1,c=this.game[this.scene-1].texts.length;c>=b;a=b+=1)this.library["t"+a].onInitEvaluation(),d.push(this.library["t"+a].addEventListener("click",this.evaluateAnswer));return d}return this.finalscene=0,setTimeout(this.storyTale,2e3)},b.prototype.storyTale=function(){var a;return TweenLite.to(this.library.cuento,1,{alpha:0,y:this.library.cuento.y-100}),this.finalscene<this.game.length?(this.setCuentoFinal(this.finalscene+1),a=createjs.Sound.play("scene"+this.scene),a.addEventListener("complete",this.storyTale),TweenLite.to(this.library.cuento,1,{alpha:1,y:this.library.cuento.y+20}),this.finalscene++):this.finish()},b.prototype.finish=function(){return TweenLite.to(this.library.title,1,{alpha:0,y:this.library.title.y+40}),b.__super__.finish.apply(this,arguments)},window.U3A5=b,b}(Oda);
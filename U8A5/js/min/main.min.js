(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,s=function(t,e){function s(){this.constructor=t}for(var n in e)i.call(e,n)&&(t[n]=e[n]);return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};t=function(t){function i(){this.finish=e(this.finish,this),this.storyTale=e(this.storyTale,this),this.nextEvaluation=e(this.nextEvaluation,this),this.finishEvaluation=e(this.finishEvaluation,this),this.evaluateAnswer=e(this.evaluateAnswer,this),this.initEvaluation=e(this.initEvaluation,this);var t,s;t=[{id:"head",src:"pleca1.png"},{id:"inst",src:"inst.png"},{id:"c1",src:"circle1.png"},{id:"c2",src:"circle2.png"},{id:"repeatbtn",src:"repeat-btn.png"},{id:"playagain",src:"play_again.png"},{id:"startgame",src:"start_game.png"},{id:"title1",src:"title1.png"},{id:"1",src:"1.png"},{id:"2",src:"2.png"},{id:"3",src:"3.png"},{id:"4",src:"4.png"},{id:"5",src:"5.png"},{id:"6",src:"6.png"},{id:"7",src:"7.png"},{id:"8",src:"8.png"},{id:"1b",src:"1b.png"},{id:"2b",src:"2b.png"},{id:"3b",src:"3b.png"},{id:"4b",src:"4b.png"},{id:"5b",src:"5b.png"},{id:"6b",src:"6b.png"},{id:"7b",src:"7b.png"},{id:"8b",src:"8b.png"},{id:"btn",src:"btn.png"}],s=[{src:"sounds/good.mp3",id:"good"},{src:"sounds/wrong.mp3",id:"wrong"},{src:"sounds/TU2_U8_A5_instructions.mp3",id:"instructions"},{src:"sounds/TU2_U8_A5_scene1.mp3",id:"scene1"},{src:"sounds/TU2_U8_A5_scene2.mp3",id:"scene2"}],this.game=[{texts:[{idx:1,t:"She makes Yen-Shen do chores all day long."},{idx:2,t:"Every day, Yen-Shen feeds the fish."},{idx:4,t:"They tell Yeh-Shen to stay at home."},{idx:3,t:"Suddenly, an old man appears."}],positions:[{x:236,y:320},{x:670,y:272},{x:236,y:720},{x:660,y:710}]},{texts:[{idx:5,t:"She looks down at her feet."},{idx:8,t:"She shows them the other golden slipper"},{idx:6,t:"She runs home, but leaves one golden slipper behind."},{idx:7,t:"The king wants to find the owner of the slipper."}],positions:[{x:230,y:280},{x:690,y:272},{x:260,y:720},{x:692,y:720}]}],this.answers=[],i.__super__.constructor.call(this,null,t,s)}return s(i,t),i.prototype.setStage=function(){var t,e;return i.__super__.setStage.apply(this,arguments),this.insertBitmap("header","head",stageSize.w/2,0,"tc"),this.insertInstructions("instructions",["Read and drag the sentences to complete the story."],80,200),e=this.createBitmap("title","title1",700,280,"tc"),e.scaleX=e.scaleY=.8,this.addToMain(e),t=new Button("btnnext",this.preload.getResult("btn"),0,1300,1040,"br"),this.addToMain(t),this.library.btnnext.visible=!1,this.addToMain(new Score("score",this.preload.getResult("c1"),this.preload.getResult("c2"),40,1e3,8,0)),this.setCuento(1).introEvaluation()},i.prototype.setCuento=function(t){var e,i,s,n,r,a,h,o,l,c;for(e=new createjs.Container,e.name="cuento",this.scene=t,i=h=1,l=this.game[t-1].positions.length;l>=h;i=h+=1)r=this.createSprite("sc"+i,[""+(4*(t-1)+i),""+(4*(t-1)+i)+"b"],null,0,0),r.mouseEnabled=!1,s=new createjs.Shape,s.graphics.beginFill("rgba(255,255,255,0.1)").drawRect(0,0,r.getBounds().width,r.getBounds().height),n=new createjs.Container,n.set({name:"sc"+i,index:4*(t-1)+i,x:this.game[t-1].positions[i-1].x,y:this.game[t-1].positions[i-1].y,sprite:r,shape:s}),n.addChild(r,s),n.scaleX=n.scaleY=1.2,e.addChild(n),this.addToLibrary(n);for(i=o=1,c=this.game[t-1].texts.length;c>=o;i=o+=1)a=new DraggableText("t"+i,this.game[t-1].texts[i-1].t,this.game[t-1].texts[i-1].idx,1400,120*i+400),a.text.lineHeight=40,a.text.lineWidth=420,a.text.textAlign="center",a.setHitArea(),this.addToLibrary(a),e.addChild(a);return this.addToMain(e),this},i.prototype.setCuentoFinal=function(t){var e,i,s,n,r,a;for(e=new createjs.Container,e.name="cuento",this.scene=t,n=this.game[t-1],i=r=1,a=n.positions.length;a>=r;i=r+=1)s=this.createBitmap(""+(4*(t-1)+i)+"b",""+(4*(t-1)+i)+"b",n.positions[i-1].x,n.positions[i-1].y),s.scaleX=s.scaleY=1.2,e.addChild(s),this.addToLibrary(s);return this.addToMain(e)},i.prototype.introEvaluation=function(){var t,e,s;for(i.__super__.introEvaluation.apply(this,arguments),t=e=1,s=this.game[this.scene-1].texts.length;s>=e;t=e+=1)this.observer.subscribe("init_evaluation",this.library["t"+t].onInitEvaluation);return TweenLite.from(this.library.header,1,{y:-this.library.header.height}),TweenLite.from(this.library.instructions,1,{alpha:0,x:0,delay:.5}),TweenLite.from(this.library.title,1,{alpha:0,y:this.library.title.y+40,delay:1}),TweenLite.from(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+40,delay:1,onComplete:this.playInstructions,onCompleteParams:[this]})},i.prototype.initEvaluation=function(){var t,e,s,n;for(i.__super__.initEvaluation.apply(this,arguments),n=[],t=e=1,s=this.game[this.scene-1].texts.length;s>=e;t=e+=1)n.push(this.library["t"+t].addEventListener("click",this.evaluateAnswer));return n},i.prototype.evaluateAnswer=function(t){var e,i,s,n,r,a,h,o,l,c,p;for(this.answer=t.currentTarget,i=!1,p=[],n=a=1,l=this.game[this.scene-1].positions.length;l>=a;n=a+=1)if(r=this.library["sc"+n].shape.globalToLocal(this.stage.mouseX,this.stage.mouseY),this.library["sc"+n].shape.hitTest(r.x,r.y))if(this.isArray(this.answer.index)){for(s=!1,c=this.answer.index,h=0,o=c.length;o>h;h++)e=c[h],e===this.library["sc"+n].index&&(s=!0);s?(this.library["sc"+n].sprite.gotoAndStop(1),this.answer.visible=!1,createjs.Sound.stop(),createjs.Sound.play("good"),this.library["sc"+n].failed||this.library.score.plusOne(),p.push(this.finishEvaluation())):(this.library["sc"+n].failed=!0,this.warning(),p.push(this.answer.returnToPlace()))}else this.answer.index===this.library["sc"+n].index?(this.library["sc"+n].sprite.gotoAndStop(1),this.answer.visible=!1,createjs.Sound.stop(),createjs.Sound.play("good"),this.library["sc"+n].failed||this.library.score.plusOne(),p.push(this.finishEvaluation())):(this.library["sc"+n].failed=!0,this.warning(),p.push(this.answer.returnToPlace()));else p.push(this.answer.returnToPlace());return p},i.prototype.finishEvaluation=function(){var t,e,i;for(t=e=1,i=this.game[this.scene-1].positions.length;i>=e;t=e+=1)if(0===this.library["sc"+t].sprite.currentFrame)return;return this.scene<2?(this.library.btnnext.visible=!0,this.library.btnnext.alpha=1,this.library.btnnext.y=1120,TweenLite.from(this.library.btnnext,1,{alpha:0,y:this.library.btnnext.y+20}),this.library.btnnext.addEventListener("click",this.nextEvaluation)):this.nextEvaluation()},i.prototype.nextEvaluation=function(){var t,e,i,s;if(this.index++,this.index<this.game.length){for(TweenLite.to(this.library.btnnext,1,{alpha:0,y:this.library.btnnext.y+20}),TweenLite.to(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+20}),this.setCuento(this.index+1),TweenLite.from(this.library.cuento,1,{alpha:0,y:this.library.cuento.y+20}),s=[],t=e=1,i=this.game[this.scene-1].texts.length;i>=e;t=e+=1)this.library["t"+t].onInitEvaluation(),s.push(this.library["t"+t].addEventListener("click",this.evaluateAnswer));return s}return this.finalscene=0,setTimeout(this.storyTale,2e3)},i.prototype.storyTale=function(){var t;return TweenLite.to(this.library.cuento,1,{alpha:0,y:this.library.cuento.y-100}),this.finalscene<this.game.length?(this.setCuentoFinal(this.finalscene+1),t=createjs.Sound.play("scene"+this.scene),t.addEventListener("complete",this.storyTale),TweenLite.to(this.library.cuento,1,{alpha:1,y:this.library.cuento.y+20}),this.finalscene++):this.finish()},i.prototype.finish=function(){return TweenLite.to(this.library.title,1,{alpha:0,y:this.library.title.y+40}),i.__super__.finish.apply(this,arguments)},window.U8A5=i,i}(Oda)}).call(this);